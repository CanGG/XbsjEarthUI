<template>
  <!-- box -->
  <div class="xbsj-template">
    <div
      class="xbsj-list"
      ref="container"
      @mousedown="startMove($event)"
      @mousemove="onMoving($event)"
      @mouseup="endMove($event)"
    >
      <div class="xbsj-list-item">
        <span class="xbsj-list-name">{{lang.plotlibrary}}</span>
        <!-- 在线 -->
        <!-- <div class="xbsj-item-btnbox ml20">
          <div
            class="xbsj-item-btn onlinebutton"
            @click="plotOnline=!plotOnline"
            :class="{highlight:plotOnline}"
          ></div>
          <span class="xbsj-item-name">{{lang.online}}</span>
        </div>-->
        <!-- Lab内置 -->
        <div class="xbsj-item-btnbox" @click="LabSymbolShow=!LabSymbolShow">
          <div class="xbsj-item-btn localhostbutton" :class="{highlight:LabSymbolShow}"></div>
          <span class="xbsj-item-name">{{lang.localhost}}</span>
        </div>
        <!-- 自定义 -->
        <div class="xbsj-item-btnbox">
          <div
            class="xbsj-item-btn symbolbutton"
            @click="CustomSymbolShow=!CustomSymbolShow"
            :class="{highlight:CustomSymbolShow}"
          ></div>
          <span class="xbsj-item-name">{{lang.custom}}</span>
        </div>
      </div>
      <div class="xbsj-list-item">
        <span class="xbsj-list-name">{{lang.routine}}</span>
        <!-- 图标点 -->
        <div class="xbsj-item-btnbox ml20" @click="pinbtn" title="图标点">
          <div class="xbsj-item-btn pinbutton"></div>
          <span class="xbsj-item-name">{{lang.pin}}</span>
        </div>
        <!-- 图片 -->
        <div class="xbsj-item-btnbox ml20" @click="pinpicturebtn" title="图片">
          <div class="xbsj-item-btn pinpicbutton"></div>
          <span class="xbsj-item-name">{{lang.pinpicturebtn}}</span>
        </div>
        <!-- div图标 -->
        <!-- <div class="xbsj-item-btnbox ml20" @click="pindivbtn" title="div图标">
          <div class="xbsj-item-btn pindivbutton"></div>
          <span class="xbsj-item-name">{{lang.pindivbtn}}</span>
        </div>-->

        <!-- 路径 -->
        <!-- <div class="xbsj-item-btnbox" @click="pathbtn" title="路径">
          <div class="xbsj-item-btn pathbutton"></div>
          <span class="xbsj-item-name">{{lang.path}}</span>
        </div>-->
        <!-- 折线 -->
        <!-- <div class="xbsj-item-btnbox" @click="polylinebtn" title="折线">
          <div class="xbsj-item-btn linebutton"></div>
          <span class="xbsj-item-name">{{lang.line}}</span>
        </div>-->
        <div class="xbsj-item-btnbox" @click="Polyline">
          <div class="xbsj-item-btn linebutton"></div>
          <span class="xbsj-item-name">{{lang.line}}</span>
        </div>

        <!-- 矩形 -->
        <div class="xbsj-item-btnbox" @click="rectangle">
          <div class="xbsj-item-btn rectanglebutton"></div>
          <span class="xbsj-item-name">{{lang.rectangle}}</span>
        </div>

        <!-- 圆 -->
        <div class="xbsj-item-btnbox" @click="circle">
          <div class="xbsj-item-btn circlebutton"></div>
          <span class="xbsj-item-name">{{lang.circle}}</span>
        </div>

        <!-- 曲线 -->
        <!-- <div class="xbsj-item-btnbox" @click="curvebtn">
          <div class="xbsj-item-btn curvedarrow"></div>
          <span class="xbsj-item-name">{{lang.curve}}</span>
        </div>-->

        <!-- 曲线箭头 -->
        <!-- <div class="xbsj-item-btnbox" @click="curvedarrowbtn">
          <div class="xbsj-item-btn curvedarrow"></div>
          <span class="xbsj-item-name">{{lang.curvedarrow}}</span>
        </div>-->

        <!-- 折线箭头 -->
        <!-- <div class="xbsj-item-btnbox" @click="PolylineArrow">
          <div class="xbsj-item-btn PolylineArrow"></div>
          <span class="xbsj-item-name">{{lang.PolylineArrow}}</span>
        </div>-->
        <!-- 扇区搜索 -->
        <!-- <div class="xbsj-item-btnbox" @click="SectorSearch">
          <div class="xbsj-item-btn Searchbutton"></div>
          <span class="xbsj-item-name">{{lang.SectorSearch}}</span>
        </div>-->
        <!-- 三角旗帜 -->
        <!-- <div class="xbsj-item-btnbox" @click="TriFlag">
          <div class="xbsj-item-btn TriFlag"></div>
          <span class="xbsj-item-name">{{lang.TriFlag}}</span>
        </div>-->
        <!-- 双箭头 -->
        <!-- <div class="xbsj-item-btnbox" @click="DoubleArrow">
          <div class="xbsj-item-btn DoubleArrow"></div>
          <span class="xbsj-item-name">{{lang.DoubleArrow}}</span>
        </div>-->
        <!-- 多边形 -->
        <div class="xbsj-item-btnbox" @click="Polygon">
          <div class="xbsj-item-btn facebutton"></div>
          <span class="xbsj-item-name">{{lang.face}}</span>
        </div>
        <!-- 标绘更多 -->
        <!-- <div class="xbsj-item-btnbox" @click="EntityMoreShow=!EntityMoreShow">
          <div class="xbsj-item-btn more"></div>
          <span class="xbsj-item-name">{{lang.more}}</span>
        </div>-->

        <!-- <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn spotbutton"></div>
          <span class="xbsj-item-name">{{lang.spot}}</span>
        </div>

        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn charactersbutton"></div>
          <span class="xbsj-item-name">{{lang.characters}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn globebutton"></div>
          <span class="xbsj-item-name">{{lang.globe}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn Cylinderbutton"></div>
          <span class="xbsj-item-name">{{lang.Cylinder}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn casebutton"></div>
          <span class="xbsj-item-name">{{lang.case}}</span>
        </div>
        <div class="xbsj-item-btnbox" @click="routineMore">
          <div class="xbsj-item-btn more"></div>
          <span class="xbsj-item-name">{{lang.more}}</span>
        </div>-->
      </div>
      <!-- 立体栏 -->
      <!-- <div class="xbsj-list-item"> -->
        <!-- <span class="xbsj-list-name">{{lang.solid}}</span> -->
        <!-- 立方体 -->
        <!-- <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn cubebutton"></div>
          <span class="xbsj-item-name">{{lang.cube}}</span>
        </div> -->
        <!-- 球体 -->
        <!-- <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn spherebutton"></div>
          <span class="xbsj-item-name">{{lang.sphere}}</span>
        </div> -->
        <!-- 模型 -->
        <!-- <div class="xbsj-item-btnbox" @click="createPlane">
          <div class="xbsj-item-btn modelbutton"></div>
          <span class="xbsj-item-name">{{lang.model}}</span>
        </div> -->
      <!-- </div> -->
        <!-- 预案编程 -->
      <div class="xbsj-list-item">
        <span class="xbsj-list-name">{{lang.model}}</span>
        <!-- 飞机模型 -->
          <!-- <div class="xbsj-item-btnbox" @click="createPlane">
            <div class="xbsj-item-btn planebutton"></div>
            <span class="xbsj-item-name">{{lang.plane}}</span>
          </div> -->
        <!-- 人 -->
        <!-- <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn characterbutton"></div>
          <span class="xbsj-item-name">{{lang.character}}</span>
        </div> -->
        <!-- 树 -->
        <!-- <div class="xbsj-item-btnbox" @click="createTree">
          <div class="xbsj-item-btn treebutton"></div>
          <span class="xbsj-item-name">{{lang.tree}}</span>
        </div> -->
        <!-- 车 -->
        <!-- <div class="xbsj-item-btnbox" @click="createCar">
          <div class="xbsj-item-btn carbutton"></div>
          <span class="xbsj-item-name">{{lang.car}}</span>
        </div>  -->
        <!-- 消防设备 -->
        <div class="xbsj-item-btnbox" @click="HyFireFighting">
          <div class="xbsj-item-btn firebutton"></div>
          <span class="xbsj-item-name">{{lang.HyFireFighting}}</span>
        </div>
        <!-- 消防车 -->
        <div class="xbsj-item-btnbox" @click="HyFireFightingEngine">
          <div class="xbsj-item-btn fireFightingTrunkbutton"></div>
          <span class="xbsj-item-name">{{lang.HyFireFightingEngine}}</span>
        </div>
        <!-- 消防人员 -->
        <div class="xbsj-item-btnbox" @click="HyFireman">
          <div class="xbsj-item-btn fireman"></div>
          <span class="xbsj-item-name">{{lang.HyFireman}}</span>
        </div>
        <!-- <div class="xbsj-item-btnbox ml20" @click="createmodelbtn">
          <div class="xbsj-item-btn modelbutton"></div>
          <span class="xbsj-item-name">{{lang.createmodel}}</span>
        </div> -->
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn more"></div>
          <span class="xbsj-item-name">{{lang.more}}</span>
        </div>
      </div>
      <!-- 动画 -->
      <!-- <div class="xbsj-list-item xbsj-list-lastitem">
        <span class="xbsj-list-name">{{lang.animation}}</span>
        <div class="xbsj-item-btnbox ml20" @click="testCircleBtn">
          <div class="xbsj-item-btn radarbutton"></div>
          <span class="xbsj-item-name">测试圆</span>
        </div>
      </div> -->
      <div class="xbsj-list-item xbsj-list-lastitem">
        <span class="xbsj-list-name">{{lang.senior}}</span>
        <!-- 路径 -->
        <div class="xbsj-item-btnbox" @click="pathbtn" title="路径">
          <div class="xbsj-item-btn pathbutton"></div>
          <span class="xbsj-item-name">{{lang.path}}</span>
        </div>
        <!-- 带杆文字 -->
        <!-- <div class="xbsj-item-btnbox" title="带杆文字">
          <div class="xbsj-item-btn barwritebutton"></div>
          <span class="xbsj-item-name">{{lang.barwrite}}</span>
        </div>-->
        <!-- 扩散面 -->
        <!-- <div class="xbsj-item-btnbox" title="扩散面">
          <div class="xbsj-item-btn pathbutton"></div>
          <span class="xbsj-item-name">{{lang.diffusionsurface}}</span>
        </div>-->
        <!-- OD线 -->
        <div class="xbsj-item-btnbox" @click="odLine" title="OD线">
          <div class="xbsj-item-btn odbutton"></div>
          <span class="xbsj-item-name">{{lang.odLine}}</span>
        </div>
        <!-- 扫描线 -->
        <div class="xbsj-item-btnbox ml20" @click="scanLineBtn">
          <div class="xbsj-item-btn radarbutton"></div>
          <span class="xbsj-item-name">{{lang.Scanline}}</span>
        </div>
        <!-- <div class="xbsj-item-btnbox ml20" @click="scanCircleBtn">
          <div class="xbsj-item-btn radarbutton"></div>
          <span class="xbsj-item-name">{{lang.ScanCircle}}</span>
        </div> -->
        <!-- 蔓延趋势 -->
        <div class="xbsj-item-btnbox ml20" @click="HySpreadBtn">
          <div class="xbsj-item-btn spread"></div>
          <span class="xbsj-item-name">{{lang.HySpread}}</span>
        </div>
        <!-- 自定义图元 -->
        <!-- <div class="xbsj-item-btnbox ml20" @click="customPrimitiveBtn">
          <div class="xbsj-item-btn radarbutton"></div>
          <span class="xbsj-item-name">{{lang.CustomPrimitive}}</span>
        </div> -->
        <!-- 管道 -->
        <!-- <div class="xbsj-item-btnbox ml20" @click="tubeBtn">
          <div class="xbsj-item-btn radarbutton"></div>
          <span class="xbsj-item-name">{{lang.tube}}</span>
        </div> -->
        <!-- 管道 -->
        <div class="xbsj-item-btnbox ml20" @click="tubeBtn">
          <div class="xbsj-item-btn tubebutton"></div>
          <span class="xbsj-item-name">{{lang.tube}}</span>
        </div>
        <!-- 自定义图元 -->
        <div class="xbsj-item-btnbox ml20" @click="customPrimitiveBtn">
          <div class="xbsj-item-btn customprimitivebutton"></div>
          <span class="xbsj-item-name">{{lang.CustomPrimitive}}</span>
        </div>
        <!-- <div class="xbsj-item-btnbox ml20">
          <div class="xbsj-item-btn odbutton"></div>
          <span class="xbsj-item-name">{{lang.od}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn waterbutton"></div>
          <span class="xbsj-item-name">{{lang.water}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn haplochromatization"></div>
          <span class="xbsj-item-name">{{lang.haplochromatization}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn particlebutton"></div>
          <span class="xbsj-item-name">{{lang.particle}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn singlearrowbutton"></div>
          <span class="xbsj-item-name">{{lang.singlearrow}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn doublearrowbutton"></div>
          <span class="xbsj-item-name">{{lang.doublearrow}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn radarbutton"></div>
          <span class="xbsj-item-name">{{lang.radar}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn ribbonbutton"></div>
          <span class="xbsj-item-name">{{lang.ribbon}}</span>
        </div>
        <div class="xbsj-item-btnbox">
          <div class="xbsj-item-btn more"></div>
          <span class="xbsj-item-name">{{lang.more}}</span>
        </div>-->
      </div>
    </div>
    <PlottingMore ref="plottingMore"></PlottingMore>
  </div>
</template>

<script>
import languagejs from "./index_locale";
import PlottingMore from "./PlottingMore/index";
export default {  
  components: {
    PlottingMore,
  },
  data() {
    return {
      selectlist: false,
      lang: {},
      langs: languagejs,
      PlottingShow: false,
      SpreadShow:false,
      EntityMoreShow: false,
      plotOnline: false,
      LabSymbolShow: false,
      CustomSymbolShow: false,
      show: true
    };
  },
  created() {},
  mounted() {},
  methods: {
    testCircleBtn(){
      console.log('testCircleBtn click');
      let earth = this.$root.$earth;
      let czm = earth.czm;
      let testCircle = new XE.Obj.CustomPrimitive(earth);
      testCircle.position = [116.39, 39.9, 10.0].xeptr;
      testCircle.canvasWidth = 256;
      testCircle.canvasHeight = 256;
      testCircle.scale = [100, 100, 1];
      testCircle.positions = XE.Obj.CustomPrimitive.Geometry.unitSquare.positions;
      testCircle.sts = XE.Obj.CustomPrimitive.Geometry.unitSquare.sts;
      testCircle.indices = XE.Obj.CustomPrimitive.Geometry.unitSquare.indices;
			// 第一个参数是背景颜色 第二个参数在那时看不出效果
      testCircle.renderState = XE.Obj.CustomPrimitive.getRenderState(true, true);
      // let r = 100;
      console.log(testCircle);
      testCircle.normals = {
        r: 100
      };

      testCircle.drawCanvas(ctx => {
          ctx.save()
          ctx.beginPath();
          ctx.arc(128,128,testCircle.normals.r,0,2*Math.PI);
          ctx.fill();
          ctx.restore();
      });
      testCircle.flyTo();
      this.$root.$earthUI.showPropertyWindow(testCircle,{component:'HyTestCircle'});
    },
    // 多边形
    Polygon() {
      var Polygon = new XE.Obj.Plots.GeoPolygon(this.$root.$earth);
      // console.log(Polygon);
      Polygon.creating = true;
      Polygon.isCreating = true;
      Polygon.name = "多边形";
      this.$root.$earthUI.showPropertyWindow(Polygon);
    },
    // 圆弧
    Arc() {
      var Arc = new XE.Obj.Plots.GeoArc(this.$root.$earth);
      Arc.creating = true;
      Arc.isCreating = true;
      Arc.name = "圆弧";
      this.$root.$earthUI.showPropertyWindow(Arc);
    },
    //双箭头
    DoubleArrow() {
      var DoubleArrow = new XE.Obj.Plots.GeoDoubleArrow(this.$root.$earth);
      // console.log(DoubleArrow);
      DoubleArrow.creating = true;
      DoubleArrow.isCreating = true;
      DoubleArrow.name = "双箭头";
      this.$root.$earthUI.showPropertyWindow(DoubleArrow);
    },
    //三角旗帜
    TriFlag() {
      var TriFlag = new XE.Obj.Plots.GeoTriFlag(this.$root.$earth);
      // console.log(TriFlag);
      TriFlag.creating = true;
      TriFlag.isCreating = true;
      TriFlag.name = "三角旗帜";
      this.$root.$earthUI.showPropertyWindow(TriFlag);
    },
    //打开扇形搜索
    SectorSearch() {
      var SectorSearch = new XE.Obj.Plots.GeoSectorSearch(this.$root.$earth);
      // console.log(SectorSearch);
      SectorSearch.creating = true;
      SectorSearch.isCreating = true;
      SectorSearch.name = "扇形搜索";
      this.$root.$earthUI.showPropertyWindow(SectorSearch);
    },
    // 打开折线弹窗
    Polyline() {
      var Polyline = new XE.Obj.Plots.GeoPolyline(this.$root.$earth);
      // console.log(Polyline);
      Polyline.creating = true;
      Polyline.isCreating = true;
      Polyline.name = "折线";
      this.$root.$earthUI.showPropertyWindow(Polyline);
    },
    // 打开折线箭头弹窗
    PolylineArrow() {
      var PolylineArrow = new XE.Obj.Plots.GeoPolylineArrow(this.$root.$earth);
      // console.log(PolylineArrow);
      PolylineArrow.creating = true;
      PolylineArrow.isCreating = true;
      PolylineArrow.name = "折线箭头";
      this.$root.$earthUI.showPropertyWindow(PolylineArrow);
    },
    // 打开矩形弹窗
    rectangle() {
      var Rectangle = new XE.Obj.Plots.GeoRectangle(this.$root.$earth);
      Rectangle.creating = true;
      Rectangle.isCreating = true;
      Rectangle.name = "矩形";
      this.$root.$earthUI.showPropertyWindow(Rectangle);
    },
    // 打开圆弹窗
    circle() {
      var Circle = new XE.Obj.Plots.GeoCircle(this.$root.$earth);
      Circle.creating = true;
      Circle.isCreating = true;
      Circle.name = "圆";
      this.$root.$earthUI.showPropertyWindow(Circle);
    },
    //打开曲线弹窗
    curvebtn() {
      var GeoCurve = new XE.Obj.Plots.GeoCurve(this.$root.$earth);
      // console.log(GeoCurveArrow);
      GeoCurve.creating = true;
      GeoCurve.isCreating = true;
      GeoCurve.name = "曲线";
      this.$root.$earthUI.showPropertyWindow(GeoCurve);
    },
    //打开曲线箭头弹窗
    curvedarrowbtn() {
      var GeoCurveArrow = new XE.Obj.Plots.GeoCurveArrow(this.$root.$earth);
      // console.log(GeoCurveArrow);
      GeoCurveArrow.creating = true;
      GeoCurveArrow.isCreating = true;
      GeoCurveArrow.name = "曲线箭头";
      this.$root.$earthUI.showPropertyWindow(GeoCurveArrow);
    },
    // 打开常规更多弹窗
    routineMore() {
      // console.log(this.$refs);
      this.$refs.plottingMore.show = !this.$refs.plottingMore.show;
    },
    //创建树模型
    createTree() {
      var Model = new XE.Obj.Model(this.$root.$earth);
      Model.url = "./assets/shu.glb";
      Model.creating = true;
      Model.isCreating = true;
      Model.name = "树";
      this.$root.$earthUI.showPropertyWindow(Model);
    },
    // 创建汽车模型
    createCar() {
      var Model = new XE.Obj.Model(this.$root.$earth);
      Model.url = "./assets/gongjiao.glb";
      Model.creating = true;
      Model.isCreating = true;
      Model.name = "汽车";
      this.$root.$earthUI.showPropertyWindow(Model);
    },
    // 创建飞机模型
    createPlane() {
      var Model = new XE.Obj.Model(this.$root.$earth);
      // console.log(Model);
      Model.url = "./assets/feiji.glb";
      Model.creating = true;
      Model.isCreating = true;
      Model.name = "模型";
      this.$root.$earthUI.showPropertyWindow(Model);
    },
    HyFireFighting(){
      alert('消防设备')
    },
    HyFireFightingEngine(){
      // alert('消防车辆')
      var earth = this.$root.$earth;
      var fireFightingEngine = {
        name: '消防车辆',
        earth: earth,
      };
      this.$root.$earthUI.showPropertyWindow(fireFightingEngine, {component:'HyFireFightingEngine'});

    },
    HyFireman(){
      alert('消防人员')
    },
    // 打开模型属性窗口
    createmodelbtn() {
      var Model = new XE.Obj.Model(this.$root.$earth);
      Model.name = "模型";
      Model.isCreating = true;
      Model.creating = true;
      this.$root.$earthUI.showPropertyWindow(Model);
    },
    // 打开path属性窗口
    pathbtn() {
      var Path = new XE.Obj.Path(this.$root.$earth);
      Path.name = "路径动画";
      Path.positionPicking = true;
      Path.isCreating = true;
      Path.creating = true;
      this.$root.$earthUI.showPropertyWindow(Path);
    },
    // 打开pin属性窗口
    pinbtn() {
      var Pin = new XE.Obj.Pin(this.$root.$earth);
      // Pin.ctrtype = "PinTool";
      Pin.name = "图标点";
      Pin.positionPicking = true;
      Pin.isCreating = true;
      Pin.creating = true;
      // console.log(Pin);
      this.$root.$earthUI.showPropertyWindow(Pin);
    },
    pindivbtn() {
      var PinDivTool = new XE.Obj.Plots.GeoPin(this.$root.$earth);
      // PinDivTool.ctrtype = "PinDivTool";
      PinDivTool.name = "div图标";
      PinDivTool.isCreating = true;
      PinDivTool.creating = true;
      PinDivTool._pin.show = false;
      this.$root.$earthUI.showPropertyWindow(PinDivTool);
    },
    pinpicturebtn() {
      var PinPictureTool = new XE.Obj.Pin(this.$root.$earth);
      // PinPictureTool.ctrtype = "PinPictureTool";
      PinPictureTool.name = "图片";
      PinPictureTool.imageUrl = "./assets/earth.png";
      PinPictureTool.positionPicking = true;
      PinPictureTool.isCreating = true;
      PinPictureTool.creating = true;
      this.$root.$earthUI.showPropertyWindow(PinPictureTool);
    },
    // OD线
    odLine() {
      var Polyline = new XE.Obj.Polyline(this.$root.$earth);
      Polyline.name = "OD线";
      Polyline.material.type = "XbsjODLineMaterial";
      Polyline.allowPicking = true;
      Polyline.isCreating = true;
      Polyline.creating = true;
      this.$root.$earthUI.showPropertyWindow(Polyline);
    },
    // 打开polyLine折线
    // polylinebtn() {
    //   var Polyline = new XE.Obj.Polyline(this.$root.$earth);
    //   Polyline.name = "折线";
    //   Polyline.allowPicking = true;
    //   Polyline.isCreating = true;
    //   Polyline.creating = true;
    //   this.$root.$earthUI.showPropertyWindow(Polyline);
    // },
    //打开扫描线-动画
    scanLineBtn() {
      var Scanline = new XE.Obj.Scanline(this.$root.$earth);
      Scanline.name = "扫描线";
      Scanline.creating = true; 
      Scanline.isCreating = true;
      Scanline.playing = true;
      this.$root.$earthUI.showPropertyWindow(Scanline);
    },
    HySpreadBtn(){
      let that = this;
      let earth = this.$root.$earth;
      let scene = earth.czm.scene;
      //创建一个自定义图元
      let Spread = new XE.Obj.CustomPrimitive(earth);
      Spread.name = "蔓延趋势";
      Spread.isCreating = true; //是否是初始化
      Spread.component = 'HySpreadTool';
      //创建
      Spread.evalString = `
        console.log('创建蔓延趋势');
      `
      //每帧刷新时
      Spread.preUpdateEvalString=`
        // console.log(p.position);
      `
      //销毁时
      Spread.disposers.push(function(){
        console.log('蔓延趋势销毁');
      })
      this.$root.$earthUI.showPropertyWindow(Spread, {component:'HySpreadTool'});
      // let earth = this.$root.$earth;
      // const evalString = `alert('evalString');`
      // const preUpdateEvalString = `alert('preUpdateEvalString');`
      // const destroyEvalString = `alert('destroyEvalString');`

    },
    scanCircleBtn(){
      // alert('扫描圆');
      var earth = this.$root.$earth;
      var scene = earth.czm.scene;
      var customPrimitive = new XE.Obj.CustomPrimitive(earth);
      // xeptr用来把经纬度的度数的数组转化成弧度的数组
      customPrimitive.position = [116.39, 39.9, 10.0].xeptr;
      customPrimitive.positions = XE.Obj.CustomPrimitive.Geometry.unitSquare.positions;
      customPrimitive.sts = XE.Obj.CustomPrimitive.Geometry.unitSquare.sts;
      customPrimitive.indices = XE.Obj.CustomPrimitive.Geometry.unitSquare.indices;
      customPrimitive.scale = [100, 100, 1];
			// 第一个参数是背景颜色 第二个参数在那时看不出效果
      customPrimitive.renderState = XE.Obj.CustomPrimitive.getRenderState(true, true);
      // 图元宽
      customPrimitive.canvasWidth = 256;
      // 高
      customPrimitive.canvasHeight = 256;
      //角度
      let angle = 0;
      //监听cesium场景的刷新事件 频率大约为0.02
      scene.preUpdate.addEventListener((el, time) => {
        angle += 1;
        if (angle > 360.0) {
            angle = 0.0;
        }
        //图元上画图
        customPrimitive.drawCanvas(ctx => {
          //清除画板内容
          ctx.clearRect(0, 0, 256, 256);
          ctx.save();
          //开画外圈
          ctx.beginPath();
          //设置边框样式
          ctx.strokeStyle = "rgb(255, 255, 0)"; 
          // setLineDash方法规定虚线的特征，它的参数是一个具有两个元素的数组。
          // 第一个数组元素规定虚线尺寸。
          // 第二个数组元素规定虚线与虚线之间的间隔，通过线段与间隔交替出现，构成了一个完整的虚线。
          ctx.setLineDash([8, 8]);
          ctx.lineWidth = 3;
          //圆弧坐标,半径, 开始角度,结束角度, 是否顺时针画
          ctx.arc(128, 128, 120, 0, Math.PI*2, true);
          //绘制边框
          ctx.stroke();
          
          //开始画内圈
          ctx.beginPath();
          ctx.arc(128, 128, 64, 0, Math.PI*2, true);
          ctx.stroke();
          ctx.restore();
          
          ctx.save();

          //设置中心点位128,128
          ctx.translate(128, 128);
          ctx.rotate(-angle * Math.PI / 180.0);

          var theta = 30;
          var headlen = 10;
          var width = 3;
          var color = 'yellow';
          var fromX = 0;
          var fromY = 0;
          var toX = 120;
          var toY = 0;
          // 计算各角度和对应的P2,P3坐标
          var angle0 = Math.atan2(fromY - toY, fromX - toX) * 180 / Math.PI,
              angle1 = (angle0 + theta) * Math.PI / 180,
              angle2 = (angle0 - theta) * Math.PI / 180,
              topX = headlen * Math.cos(angle1),
              topY = headlen * Math.sin(angle1),
              botX = headlen * Math.cos(angle2),
              botY = headlen * Math.sin(angle2);

          ctx.save();
          ctx.beginPath();

          var arrowX = fromX - topX,
              arrowY = fromY - topY;

          ctx.moveTo(arrowX, arrowY);
          ctx.moveTo(fromX, fromY);
          ctx.lineTo(toX, toY);
          arrowX = toX + topX;
          arrowY = toY + topY;
          ctx.moveTo(arrowX, arrowY);
          ctx.lineTo(toX, toY);
          arrowX = toX + botX;
          arrowY = toY + botY;
          ctx.lineTo(arrowX, arrowY);
          ctx.strokeStyle = color;
          ctx.lineWidth = width;
          ctx.stroke();
          ctx.restore();

          ctx.font = "12px Microsoft YaHei";
          ctx.fillStyle = "rgb(256, 255, 0)";
          ctx.fillText("5公里", 40, -5);

          ctx.restore();
        });
      });
      // customPrimitive.flyTo();
      window.tt = customPrimitive;
      let viewer = earth._viewer;
      let handler = new Cesium.ScreenSpaceEventHandler(viewer.canvas);
      handler.setInputAction(event => {
        var cartographic = earth.pickPosition(event.endPosition);
        customPrimitive.position = cartographic;
        console.log(customPrimitive.show);
        console.log(customPrimitive.position);
      }, Cesium.ScreenSpaceEventType.MOUSE_MOVE);
    
      let startTime;
      handler.setInputAction(event => {
        console.log('left_down')
        console.log(event)
        startTime = new Date();
      }, Cesium.ScreenSpaceEventType.LEFT_DOWN);

      let endTime;
      handler.setInputAction(event => {
        console.log('left_up')
        console.log(event)
        endTime = new Date();
        console.log(startTime);
        console.log(endTime);
        console.log(endTime - startTime);
        if(endTime - startTime < 200){
          handler.removeInputAction( Cesium.ScreenSpaceEventType.MOUSE_MOVE)
          handler.removeInputAction( Cesium.ScreenSpaceEventType.LEFT_DOWN)
          handler.removeInputAction( Cesium.ScreenSpaceEventType.LEFT_UP)
        }
      }, Cesium.ScreenSpaceEventType.LEFT_UP);

      customPrimitive.creating = true;
      customPrimitive.isCreating = true;
      customPrimitive.name = "蔓延趋势";
      var pin = new XE.Obj.Pin(earth);
      pin.position = [...customPrimitive.position];
      pin.show = false;
      var ub = XE.MVVM.bind(pin, 'position', customPrimitive, 'position');
      pin.editing = false;
    },
    //打开自定义图元-动画
    customPrimitiveBtn() {
      var CustomPrimitive = new XE.Obj.CustomPrimitive(this.$root.$earth);
      CustomPrimitive.name = "自定义图元";
      CustomPrimitive.autoRegisterEditing = true;

      CustomPrimitive.isCreating = true;
      CustomPrimitive.creating = true;
      console.log(CustomPrimitive);
      this.$root.$earthUI.showPropertyWindow(CustomPrimitive);
    },
    //打开管道-动画
    tubeBtn() {
      var Tube = new XE.Obj.CustomPrimitiveExt.Tube(this.$root.$earth);
      Tube.name = "管道";
      Tube.isCreating = true;
      Tube.creating = true;
      console.log(Tube);
      this.$root.$earthUI.showPropertyWindow(Tube);
    },
    startMove(event) {
      //如果事件的目标不是本el 返回
      if (
        event.target.parentElement !== this.$refs.container &&
        event.target.parentElement.parentElement !== this.$refs.container
      ) {
        this.moving = false;
        return;
      }
      this.moving = true;
    },
    onMoving(event) {
      //获取鼠标和为开始位置的插值，滚动滚动条
      if (!this.moving) return;

      var dom = this.$refs.container;
      var wleft = dom.scrollLeft - event.movementX;
      if (wleft >= 0 && wleft <= dom.scrollWidth - dom.clientWidth) {
        dom.scrollLeft = wleft;
      }
    },
    endMove(envent) {
      this.moving = false;
    }
  }
};
</script>

<style>
.DoubleArrow {
  background: url(../../../../images/doublearrow.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.DoubleArrow:hover {
  background: url(../../../../images/doublearrow_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}

.TriFlag {
  background: url(../../../../images/TriFlag.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.TriFlag:hover {
  background: url(../../../../images/TriFlag_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}

/* .SectorSearch {
  background: url(../../../../images/SectorSearch.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.SectorSearch:hover {
  background: url(../../../../images/SectorSearch_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
} */

.PolylineArrow {
  background: url(../../../../images/PolylineArrow.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.PolylineArrow:hover {
  background: url(../../../../images/PolylineArrow_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.curvedarrow {
  background: url(../../../../images/CurveArrow.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.curvedarrow:hover {
  background: url(../../../../images/CurveArrow_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}

.modelbutton {
  background: url(../../../../images/createmodel.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.modelbutton:hover {
  background: url(../../../../images/createmodel_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}

.pathbutton {
  background: url(../../../../images/path.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.pathbutton:hover {
  background: url(../../../../images/path_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.pinbutton {
  background: url(../../../../images/pin.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.pinbutton:hover {
  background: url(../../../../images/pin_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.pinpicbutton {
  background: url(../../../../images/pinpic.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.pinpicbutton:hover {
  background: url(../../../../images/pinpic_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.pindivbutton {
  background: url(../../../../images/pindiv.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.pindivbutton:hover {
  background: url(../../../../images/pindiv_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.Searchbutton {
  background: url(../../../../images/GeoSectorSearch.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.Searchbutton:hover {
  background: url(../../../../images/GeoSectorSearch_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}

.spotbutton {
  background: url(../../../../images/spot.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.spotbutton:hover {
  background: url(../../../../images/spot_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.linebutton {
  background: url(../../../../images/line.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.linebutton:hover {
  background: url(../../../../images/line_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.facebutton {
  background: url(../../../../images/face.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.facebutton:hover {
  background: url(../../../../images/face_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.charactersbutton {
  background: url(../../../../images/characters.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.charactersbutton:hover {
  background: url(../../../../images/characters_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.globebutton {
  background: url(../../../../images/globe.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.globebutton:hover {
  background: url(../../../../images/globe_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.Cylinderbutton {
  background: url(../../../../images/Cylinder.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.Cylinderbutton:hover {
  background: url(../../../../images/Cylinder_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.casebutton {
  background: url(../../../../images/case.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.casebutton:hover {
  background: url(../../../../images/case_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.more {
  background: url(../../../../images/more.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.more:hover {
  background: url(../../../../images/more_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.planebutton {
  background: url(../../../../images/plane.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.planebutton:hover {
  background: url(../../../../images/plane_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.characterbutton {
  background: url(../../../../images/character.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.characterbutton:hover {
  background: url(../../../../images/character_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.treebutton {
  background: url(../../../../images/tree.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.treebutton:hover {
  background: url(../../../../images/tree_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.carbutton {
  background: url(../../../../images/car.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.carbutton:hover {
  background: url(../../../../images/car_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.waterbutton {
  background: url(../../../../images/water.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.waterbutton:hover {
  background: url(../../../../images/water_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.haplochromatization {
  background: url(../../../../images/haplochromatization.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.haplochromatization:hover {
  background: url(../../../../images/haplochromatization_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.particlebutton {
  background: url(../../../../images/particle.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.particlebutton:hover {
  background: url(../../../../images/particle_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.singlearrowbutton {
  background: url(../../../../images/singlearrow.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.singlearrowbutton:hover {
  background: url(../../../../images/singlearrow_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.doublearrowbutton {
  background: url(../../../../images/doublearrow.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.doublearrowbutton:hover {
  background: url(../../../../images/doublearrow_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.radarbutton {
  background: url(../../../../images/radar.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.radarbutton:hover {
  background: url(../../../../images/radar_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.ribbonbutton {
  background: url(../../../../images/ribbon.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.ribbonbutton:hover {
  background: url(../../../../images/ribbon_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.odbutton {
  background: url(../../../../images/od.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.odbutton:hover {
  background: url(../../../../images/od_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.depthdetectionbutton {
  background: url(../../../../images/depth-terrain.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.depthdetectionbutton.highlight,
.depthdetectionbutton:hover {
  background: url(../../../../images/depth-terrain_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.firebutton {
  background: url(../../../../images/fire-fighting.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.firebutton:hover {
  background: url(../../../../images/fire-fighting_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.fireFightingTrunkbutton {
  background: url(../../../../images/fire-fighting-trunk.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.fireFightingTrunkbutton:hover {
  background: url(../../../../images/fire-fighting-trunk_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.fireman {
  background: url(../../../../images/fireman.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.fireman:hover {
  background: url(../../../../images/fireman_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.spread {
  background: url(../../../../images/spread.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.spread:hover {
  background: url(../../../../images/spread_on.png) no-repeat;
}
.onlinebutton {
  background: url(../../../../images/online.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.onlinebutton.highlight,
.onlinebutton:hover {
  background: url(../../../../images/online_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.localhostbutton {
  background: url(../../../../images/localhost.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.localhostbutton.highlight,
.localhostbutton:hover {
  background: url(../../../../images/localhost_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.symbolbutton {
  background: url(../../../../images/symbol.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.symbolbutton.highlight,
.symbolbutton:hover {
  background: url(../../../../images/symbol_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.rectanglebutton {
  background: url(../../../../images/rectangle.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.rectanglebutton.highlight,
.rectanglebutton:hover {
  background: url(../../../../images/rectangle_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.circlebutton {
  background: url(../../../../images/circle.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.circlebutton.highlight,
.circlebutton:hover {
  background: url(../../../../images/circle_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.cubebutton {
  background: url(../../../../images/cube.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.cubebutton.highlight,
.cubebutton:hover {
  background: url(../../../../images/cube_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.spherebutton {
  background: url(../../../../images/sphere.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.spherebutton.highlight,
.spherebutton:hover {
  background: url(../../../../images/sphere_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.barwritebutton {
  background: url(../../../../images/barwrite.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.barwritebutton.highlight,
.barwritebutton:hover {
  background: url(../../../../images/barwrite_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.odbutton {
  background: url(../../../../images/od.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.odbutton.highlight,
.odbutton:hover {
  background: url(../../../../images/od_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.tubebutton {
  background: url(../../../../images/tube.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.tubebutton.highlight,
.tubebutton:hover {
  background: url(../../../../images/tube_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.customprimitivebutton {
  background: url(../../../../images/customprimitive.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
.customprimitivebutton.highlight,
.customprimitivebutton:hover {
  background: url(../../../../images/customprimitive_on.png) no-repeat;
  background-size: contain;
  cursor: pointer;
}
</style>

