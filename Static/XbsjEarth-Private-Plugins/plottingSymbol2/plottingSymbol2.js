!function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,i){!function(e,t){if(!M[e]||!S[e])return;for(var i in S[e]=!1,t)Object.prototype.hasOwnProperty.call(t,i)&&(u[i]=t[i]);0==--C&&0===_&&P()}(e,i),t&&t(e,i)};var i,s=!0,r="8d69fcfac107046616ba",o={},a=[],n=[];function h(e){var t=T[e];if(!t)return O;var s=function(s){return t.hot.active?(T[s]?-1===T[s].parents.indexOf(e)&&T[s].parents.push(e):(a=[e],i=s),-1===t.children.indexOf(s)&&t.children.push(s)):(console.warn("[HMR] unexpected require("+s+") from disposed module "+e),a=[]),O(s)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return O[e]},set:function(t){O[e]=t}}};for(var o in O)Object.prototype.hasOwnProperty.call(O,o)&&"e"!==o&&"t"!==o&&Object.defineProperty(s,o,r(o));return s.e=function(e){return"ready"===p&&m("prepare"),_++,O.e(e).then(t,(function(e){throw t(),e}));function t(){_--,"prepare"===p&&(g[e]||x(e),0===_&&0===C&&P())}},s.t=function(e,t){return 1&t&&(e=s(e)),O.t(e,-2&t)},s}function l(t){var s={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:i!==t,active:!0,accept:function(e,t){if(void 0===e)s._selfAccepted=!0;else if("function"==typeof e)s._selfAccepted=e;else if("object"==typeof e)for(var i=0;i<e.length;i++)s._acceptedDependencies[e[i]]=t||function(){};else s._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)s._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)s._declinedDependencies[e[t]]=!0;else s._declinedDependencies[e]=!0},dispose:function(e){s._disposeHandlers.push(e)},addDisposeHandler:function(e){s._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=s._disposeHandlers.indexOf(e);t>=0&&s._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,p){case"idle":(u={})[t]=e[t],m("ready");break;case"ready":I(t);break;case"prepare":case"check":case"dispose":case"apply":(y=y||[]).push(t)}},check:v,apply:E,status:function(e){if(!e)return p;c.push(e)},addStatusHandler:function(e){c.push(e)},removeStatusHandler:function(e){var t=c.indexOf(e);t>=0&&c.splice(t,1)},data:o[t]};return i=void 0,s}var c=[],p="idle";function m(e){p=e;for(var t=0;t<c.length;t++)c[t].call(null,e)}var d,u,f,y,C=0,_=0,g={},S={},M={};function w(e){return+e+""===e?+e:e}function v(e){if("idle"!==p)throw new Error("check() is only allowed in idle status");return s=e,m("check"),(t=1e4,t=t||1e4,new Promise((function(e,i){if("undefined"==typeof XMLHttpRequest)return i(new Error("No browser support"));try{var s=new XMLHttpRequest,o=O.p+""+r+".hot-update.json";s.open("GET",o,!0),s.timeout=t,s.send(null)}catch(e){return i(e)}s.onreadystatechange=function(){if(4===s.readyState)if(0===s.status)i(new Error("Manifest request to "+o+" timed out."));else if(404===s.status)e();else if(200!==s.status&&304!==s.status)i(new Error("Manifest request to "+o+" failed."));else{try{var t=JSON.parse(s.responseText)}catch(e){return void i(e)}e(t)}}}))).then((function(e){if(!e)return m(b()?"ready":"idle"),null;S={},g={},M=e.c,f=e.h,m("prepare");var t=new Promise((function(e,t){d={resolve:e,reject:t}}));u={};return x(0),"prepare"===p&&0===_&&0===C&&P(),t}));var t}function x(e){M[e]?(S[e]=!0,C++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=O.p+""+e+"."+r+".hot-update.js",document.head.appendChild(t)}(e)):g[e]=!0}function P(){m("ready");var e=d;if(d=null,e)if(s)Promise.resolve().then((function(){return E(s)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var i in u)Object.prototype.hasOwnProperty.call(u,i)&&t.push(w(i));e.resolve(t)}}function E(t){if("ready"!==p)throw new Error("apply() is only allowed in ready status");return function t(s){var n,h,l,c,p;function d(e){for(var t=[e],i={},s=t.map((function(e){return{chain:[e],id:e}}));s.length>0;){var r=s.pop(),o=r.id,a=r.chain;if((c=T[o])&&(!c.hot._selfAccepted||c.hot._selfInvalidated)){if(c.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:o};if(c.hot._main)return{type:"unaccepted",chain:a,moduleId:o};for(var n=0;n<c.parents.length;n++){var h=c.parents[n],l=T[h];if(l){if(l.hot._declinedDependencies[o])return{type:"declined",chain:a.concat([h]),moduleId:o,parentId:h};-1===t.indexOf(h)&&(l.hot._acceptedDependencies[o]?(i[h]||(i[h]=[]),C(i[h],[o])):(delete i[h],t.push(h),s.push({chain:a.concat([h]),id:h})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:i}}function C(e,t){for(var i=0;i<t.length;i++){var s=t[i];-1===e.indexOf(s)&&e.push(s)}}b();var _={},g=[],S={},v=function(){console.warn("[HMR] unexpected require("+P.moduleId+") to disposed module")};for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)){var P;p=w(x),P=u[x]?d(p):{type:"disposed",moduleId:x};var E=!1,I=!1,z=!1,L="";switch(P.chain&&(L="\nUpdate propagation: "+P.chain.join(" -> ")),P.type){case"self-declined":s.onDeclined&&s.onDeclined(P),s.ignoreDeclined||(E=new Error("Aborted because of self decline: "+P.moduleId+L));break;case"declined":s.onDeclined&&s.onDeclined(P),s.ignoreDeclined||(E=new Error("Aborted because of declined dependency: "+P.moduleId+" in "+P.parentId+L));break;case"unaccepted":s.onUnaccepted&&s.onUnaccepted(P),s.ignoreUnaccepted||(E=new Error("Aborted because "+p+" is not accepted"+L));break;case"accepted":s.onAccepted&&s.onAccepted(P),I=!0;break;case"disposed":s.onDisposed&&s.onDisposed(P),z=!0;break;default:throw new Error("Unexception type "+P.type)}if(E)return m("abort"),Promise.reject(E);if(I)for(p in S[p]=u[p],C(g,P.outdatedModules),P.outdatedDependencies)Object.prototype.hasOwnProperty.call(P.outdatedDependencies,p)&&(_[p]||(_[p]=[]),C(_[p],P.outdatedDependencies[p]));z&&(C(g,[P.moduleId]),S[p]=v)}var X,V=[];for(h=0;h<g.length;h++)p=g[h],T[p]&&T[p].hot._selfAccepted&&S[p]!==v&&!T[p].hot._selfInvalidated&&V.push({module:p,parents:T[p].parents.slice(),errorHandler:T[p].hot._selfAccepted});m("dispose"),Object.keys(M).forEach((function(e){!1===M[e]&&function(e){delete installedChunks[e]}(e)}));var R,k,j=g.slice();for(;j.length>0;)if(p=j.pop(),c=T[p]){var W={},D=c.hot._disposeHandlers;for(l=0;l<D.length;l++)(n=D[l])(W);for(o[p]=W,c.hot.active=!1,delete T[p],delete _[p],l=0;l<c.children.length;l++){var H=T[c.children[l]];H&&((X=H.parents.indexOf(p))>=0&&H.parents.splice(X,1))}}for(p in _)if(Object.prototype.hasOwnProperty.call(_,p)&&(c=T[p]))for(k=_[p],l=0;l<k.length;l++)R=k[l],(X=c.children.indexOf(R))>=0&&c.children.splice(X,1);m("apply"),void 0!==f&&(r=f,f=void 0);for(p in u=void 0,S)Object.prototype.hasOwnProperty.call(S,p)&&(e[p]=S[p]);var A=null;for(p in _)if(Object.prototype.hasOwnProperty.call(_,p)&&(c=T[p])){k=_[p];var N=[];for(h=0;h<k.length;h++)if(R=k[h],n=c.hot._acceptedDependencies[R]){if(-1!==N.indexOf(n))continue;N.push(n)}for(h=0;h<N.length;h++){n=N[h];try{n(k)}catch(e){s.onErrored&&s.onErrored({type:"accept-errored",moduleId:p,dependencyId:k[h],error:e}),s.ignoreErrored||A||(A=e)}}}for(h=0;h<V.length;h++){var B=V[h];p=B.module,a=B.parents,i=p;try{O(p)}catch(e){if("function"==typeof B.errorHandler)try{B.errorHandler(e)}catch(t){s.onErrored&&s.onErrored({type:"self-accept-error-handler-errored",moduleId:p,error:t,originalError:e}),s.ignoreErrored||A||(A=t),A||(A=e)}else s.onErrored&&s.onErrored({type:"self-accept-errored",moduleId:p,error:e}),s.ignoreErrored||A||(A=e)}}if(A)return m("fail"),Promise.reject(A);if(y)return t(s).then((function(e){return g.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e}));return m("idle"),new Promise((function(e){e(g)}))}(t=t||{})}function b(){if(y)return u||(u={}),y.forEach(I),y=void 0,!0}function I(t){Object.prototype.hasOwnProperty.call(u,t)||(u[t]=e[t])}var T={};function O(t){if(T[t])return T[t].exports;var i=T[t]={i:t,l:!1,exports:{},hot:l(t),parents:(n=a,a=[],n),children:[]};return e[t].call(i.exports,i,i.exports,h(t)),i.l=!0,i.exports}O.m=e,O.c=T,O.d=function(e,t,i){O.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},O.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},O.t=function(e,t){if(1&t&&(e=O(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(O.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)O.d(i,s,function(t){return e[t]}.bind(null,s));return i},O.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return O.d(t,"a",t),t},O.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},O.p="",O.h=function(){return r},h(0)(O.s=0)}([function(e,t,i){"use strict";i.r(t);class s extends XE.Obj.PlotBase{constructor(e,t){super(e,t),this._onlyMove=!1,this._fixedPositionsNum=void 0,XE.MVVM.extend(this,{_polygonShow:!0}),this._polygon=new XE.Obj.Polygon(e),this.disposers.push(()=>{this._polygon=this._polygon&&this._polygon.destroy()}),this._polygon.show=this._polygonShow&&this.show,XE.Earth.Interaction.Picking.registerPickingParent(this._polygon,this);const i=()=>{this._polygon.show=this._polygonShow&&this.show,this._polygon.width=this.width,this._polygon.color=this.color,this._polygon.ground=this.ground,this._polygon.outline.width=this.outlineWidth,this._polygon.outline.color=this.outlineColor,this._polygon.outline.show=this.outlineShow,this._polygon.depthTest=this.depthTest};i(),this.disposers.push(XE.MVVM.watch(()=>({show:this._polygonShow&&this.show,width:this.width,color:[...this.color],ground:this.ground,outlineWidth:this.outlineWidth,outlineColor:this.outlineColor,outlineShow:this.outlineShow,depthTest:this.depthTest}),()=>i()))}get onlyMove(){return this._onlyMove}get fixedPositionsNum(){return this._fixedPositionsNum}flyTo(){this._polygon.flyTo()}}s.defaultOptions={positions:[],show:!0,color:[0,1,0,.1],outlineWidth:2,outlineColor:[0,1,0,1],outlineShow:!0,depthTest:!1};var r=s;const o=XE.Tool;class a extends r{constructor(e,t){super(e,t),this._onlyMove=!0,this._polygonPositions=[],this.disposers.push(XE.MVVM.watch(()=>({minWidthScale:this.minWidthScale,dynamicWidthScale:this.dynamicWidthScale,arrowMaxHeightScale:this.arrowMaxHeightScale,arrowWingWidthScale:this.arrowWingWidthScale}),()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)})),this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(e=>[...e])],()=>{this.change(this.positions,this.minWidthScale,this.dynamicWidthScale,this.arrowMaxHeightScale,this.arrowWingWidthScale)}))}change(e,t=.06,i=.1,s=.1,r=2){let a=[...e];const n=a.length;if(n<2||function(e,t){if(!e||!t)return!1;h=0;for(let i=0;i<e.length;i++)if(h=e[i]==t[i]?0:1,h>0)return!1;return!0}(a[n-1],a[n-2]))return;console.clear=function(){};let l=a.map(e=>Cesium.Cartesian3.fromRadians(...e,null,new Cesium.Cartesian3));this._polygonPositions.length=0;let c,p,m,d,u,f,y,C=[0,0,0],_=new Array(n).fill(0).map((e,t)=>(c=a[t-1],p=a[t+1],m=a[t],d=c?o.Math.hpr(m,c,C)[0]:0,u=p?o.Math.hpr(m,p,C)[0]:0,f=d&&u?2:1,y=(d+u)/f,y=d>u?y:y-Cesium.Math.PI,y<0?y+Cesium.Math.TWO_PI:y)),g=0,S=[];l.forEach((e,t)=>{c=l[t-1]||e,p=e,g+=Cesium.Cartesian3.distance(c,p),S.push(g)}),S=S.map(e=>g-e);const M=(i/=2)*g,w=(t/=2)*g;let v=new Array(S.length).fill(0).map((e,t)=>w+M*S[t]/g),x=function(e,t,i,s,r,a){let n=e*t,h=.7*n,l=Cesium.Cartesian3.distance(r[0],r[1]);l<h&&(h=l,n=h/.7);let c=o.Math.hpr(a[1],a[0],[0,0,0])[0],p=o.Math.geoMove(a[1],c,h,[0,0,0]),m=o.Math.geoMove(a[1],c,n,[0,0,0]),d=o.Math.hpr(p,a[1],[0,0,0])[0],u=o.Math.hpr(m,a[1],[0,0,0])[0],f=new Array(5);return f[0]=o.Math.geoMove(p,d-Cesium.Math.PI_OVER_TWO,i,[0,0,0]),f[4]=o.Math.geoMove(p,d+Cesium.Math.PI_OVER_TWO,i,[0,0,0]),f[1]=o.Math.geoMove(m,u-Cesium.Math.PI_OVER_TWO,i*s,[0,0,0]),f[3]=o.Math.geoMove(m,u+Cesium.Math.PI_OVER_TWO,i*s,[0,0,0]),f[2]=[...a[1]],f}(g,s,w,r,l.slice(-2),a.slice(-2)),P=[],E=[];a.forEach((e,t)=>{0==t||t==n-1?(P.push(o.Math.geoMove(e,_[t]+Cesium.Math.PI_OVER_TWO,v[t])),E.push(o.Math.geoMove(e,_[t]-Cesium.Math.PI_OVER_TWO,v[t]))):(P.push(o.Math.geoMove(e,_[t]-Cesium.Math.PI,v[t])),E.push(o.Math.geoMove(e,_[t],v[t])))}),P.pop(),E.pop(),P.push(x[0]),E.push(x[x.length-1]);let b=o.Math.interpolatePositions(P,20*n,!1,[]),I=o.Math.interpolatePositions(E,20*n,!1,[]);b.forEach(e=>{this._polygonPositions.push(e[0],e[1])}),x.forEach(e=>{this._polygonPositions.push(e[0],e[1])});for(let e=I.length-1;e>=0;e--)this._polygonPositions.push(I[e][0],I[e][1]);this._polygon.positions=this._polygonPositions,this._polygon.height=a[0][2],this._polygonShow=!0}}a.registerType(a,"GeoArrow"),a.defaultOptions={minWidthScale:.06,dynamicWidthScale:.1,arrowMaxHeightScale:.1,arrowWingWidthScale:2};var n=a;let h;let l=new Cesium.Cartesian3;XE.Tool;class c extends XE.Core.XbsjCzmObj{constructor(e,t){super(e,t),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"positionEditing"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerRotationEditing(this._earth,this,{rotationEditingProperty:"rotationEditing"})),this._viewer=e.czm.viewer;let i=new Cesium.Cartesian3;Cesium.Cartesian3.fromRadians(...this.position,null,i),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(i),this._updateCallback=()=>{},this._particleSystem=new Cesium.ParticleSystem({image:this.image,startColor:Cesium.Color.LIGHTSEAGREEN.withAlpha(.7),endColor:Cesium.Color.WHITE.withAlpha(0),startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:this._modelMatrix,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:new Cesium.CircleEmitter(2),updateCallback:this._updateCallback}),this._viewer.scene.primitives.add(this._particleSystem),this.disposers.push(XE.MVVM.watch(()=>({startColor:[...this.startColor],endColor:[...this.endColor],image:this.image,emissionRate:this.emissionRate,maximumSpeed:this.maximumSpeed,minimumSpeed:this.minimumSpeed,minimumImageSize:this.minimumImageSize,maximumImageSize:this.maximumImageSize,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife}),()=>this.update())),this.disposers.push(XE.MVVM.watch(()=>({image:this.image}),()=>this.updateParticleSystem())),this.disposers.push(XE.MVVM.watch(()=>({particleSize:this.particleSize}),()=>this.updateParticleSize())),this.disposers.push(XE.MVVM.watch(()=>[...this.position,...this.rotation],()=>this.updateMatrix())),this.disposers.push(XE.MVVM.watch(()=>({gravity:this.gravity}),()=>{this._particleSystem.updateCallback=this.updateGravity(this.gravity)})),this.disposers.push(XE.MVVM.watch(()=>({emitterRadius:this.emitterRadius,emitterAngle:this.emitterAngle,emitterType:this.emitterType}),()=>this.updateEmitter()))}updateMatrix(){let e=new Cesium.Cartesian3,t=new Cesium.Matrix4;Cesium.Cartesian3.fromRadians(...this.position,null,e),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(e);let i=new Cesium.HeadingPitchRoll(...this.rotation),s=Cesium.Quaternion.fromHeadingPitchRoll(i,new Cesium.Quaternion);t=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,s,new Cesium.Cartesian3(1,1,1),t),Cesium.Matrix4.multiply(this._modelMatrix,t,this._modelMatrix),this._particleSystem.modelMatrix=this._modelMatrix}updateParticleSize(){this._particleSystem.imageSize?(this._particleSystem.imageSize.x=this.particleSize,this._particleSystem.imageSize.y=this.particleSize,this._particleSystem.maximumImageSize.x=this.particleSize,this._particleSystem.maximumImageSize.y=this.particleSize,this._particleSystem.minimumImageSize.x=this.particleSize,this._particleSystem.minimumImageSize.y=this.particleSize):this._particleSystem.imageSize=new Cesium.Cartesian2(this.particleSize,this.particleSize)}updateParticleSystem(){this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0),this._particleSystem=new Cesium.ParticleSystem({image:this.image,startColor:{red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},endColor:{red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},startScale:this.startScale,endScale:this.endScale,minimumParticleLife:this.minimumParticleLife,maximumParticleLife:this.maximumParticleLife,minimumSpeed:this.minimumSpeed,maximumSpeed:this.maximumSpeed,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,lifetime:16,modelMatrix:this._modelMatrix,emitterModelMatrix:Cesium.Matrix4.IDENTITY,emitter:this._emitter,updateCallback:this._updateCallback}),this._viewer.scene.primitives.add(this._particleSystem)}update(){this._particleSystem.startColor={red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},this._particleSystem.endColor={red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]},this._particleSystem.startScale=this.startScale,this._particleSystem.endScale=this.endScale,this._particleSystem.emissionRate=this.emissionRate,this._particleSystem.minimumSpeed=this.minimumSpeed,this._particleSystem.maximumSpeed=this.maximumSpeed,this._particleSystem.minimumParticleLife=this.minimumParticleLife,this._particleSystem.maximumParticleLife=this.maximumParticleLife}updateGravity(e){return this._updateCallback=(t,i)=>{Cesium.Cartesian3.normalize(t.position,l),Cesium.Cartesian3.multiplyByScalar(l,e*i,l),t.velocity=Cesium.Cartesian3.add(t.velocity,l,t.velocity)}}updateEmitter(){let e;if(e="BoxEmitter"!=this.emitterType?"ConeEmitter"==this.emitterType?this.emitterAngle:this.emitterRadius:new Cesium.Cartesian3(...new Array(3).fill(this.emitterRadius)),!this._particleSystem)return this._emitter=new Cesium[this.emitterType](e),this._emitter;this._particleSystem.emitter=new Cesium[this.emitterType](e),this._emitter=this._particleSystem.emitter}flyTo(){if(this._particleSystem){let e=Math.abs(this._particleSystem.minimumSpeed)>Math.abs(this._particleSystem.maximumSpeed)?Math.abs(this._particleSystem.minimumSpeed):Math.abs(this._particleSystem.maximumSpeed),t=Math.abs(this._particleSystem.minimumParticleLife)>Math.abs(this._particleSystem.maximumParticleLife)?Math.abs(this._particleSystem.minimumParticleLife):Math.abs(this._particleSystem.maximumParticleLife),i=new Cesium.Cartesian3;Cesium.Matrix4.getColumn(this._particleSystem.modelMatrix,3,i);let s=e*t,r=new Cesium.BoundingSphere(i,s);this._viewer.camera.flyToBoundingSphere(r,{duration:2})}}destroy(){this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0)}}c.defaultOptions={startColor:[.12549,.69804,.66667,.7],endColor:[1,1,1,0],position:[1.6988083400554626,.6666896940162155,0],rotation:[0,0,0],emissionRate:5,gravity:0,minimumParticleLife:2,maximumParticleLife:2,minimumSpeed:1,maximumSpeed:4,startScale:1,endScale:5,particleSize:25,image:"../../XbsjEarth-Plugins/plottingSymbol2/assets/SampleData/smoke.png",emitterRadius:2,emitterAngle:1,emitterType:"CircleEmitter"},c.registerType(c,"ParticleSystem");var p=c;let m;var d=function(){if(!m){m=document.createElement("canvas"),m.width=20,m.height=20;var e=m.getContext("2d");e.beginPath(),e.arc(8,8,8,0,Cesium.Math.TWO_PI,!0),e.closePath(),e.fillStyle="rgb(255, 255, 255)",e.fill()}return m};new Cesium.Cartesian3;XE.Tool;class u extends XE.Core.XbsjCzmObj{constructor(e,t){super(e,t),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"editing"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this._viewer=e.czm.viewer,this._modelMatrix=this._modelMatrix||Cesium.Matrix4.IDENTITY,this._position=new Cesium.Cartesian3,this._particleSystem=new Cesium.ParticleSystem({image:d(),startColor:{red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},endColor:{red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:0},particleLife:this.particleLife,speed:this.radius/this.particleLife||0,imageSize:new Cesium.Cartesian2(7,7),bursts:[new Cesium.ParticleBurst({time:0,minimum:400,maximum:400})],emissionRate:0,lifetime:this.particleLife+this.burstInterval||2,modelMatrix:this._modelMatrix,emitter:new Cesium.SphereEmitter(.1)}),this._viewer.scene.primitives.add(this._particleSystem),this.disposers.push(XE.MVVM.watch(()=>({startColor:[...this.startColor],endColor:[...this.endColor]}),()=>this.updateColor())),this.disposers.push(XE.MVVM.watch(()=>({radius:this.radius,particleLife:this.particleLife,burstInterval:this.burstInterval}),()=>this.updateInitialVelocity())),this.disposers.push(XE.MVVM.watch(()=>({position:[...this.position]}),()=>this.updateModelMatrix())),this.flyTo()}updateColor(){this._particleSystem.startColor={red:this.startColor[0],green:this.startColor[1],blue:this.startColor[2],alpha:this.startColor[3]},this._particleSystem.endColor={red:this.endColor[0],green:this.endColor[1],blue:this.endColor[2],alpha:this.endColor[3]}}updateModelMatrix(){Cesium.Cartesian3.fromRadians(...this.position,null,this._position),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position),this._particleSystem.modelMatrix=this._modelMatrix}updateInitialVelocity(){this._initialVelocity=this.radius/this.particleLife,this._particleSystem.lifetime=this.particleLife+this.burstInterval,this._particleSystem.minimumParticleLife=this.particleLife,this._particleSystem.maximumParticleLife=this.particleLife,this._particleSystem.minimumSpeed=this._initialVelocity,this._particleSystem.maximumSpeed=this._initialVelocity}flyTo(){this.boundingSphere=new Cesium.BoundingSphere(this._position,this.radius),this._viewer.camera.flyToBoundingSphere(this.boundingSphere,{duration:2})}destroy(){this._particleSystem&&(this._viewer.scene.primitives.remove(this._particleSystem),this._particleSystem=void 0)}}u.defaultOptions={radius:200,particleLife:.8,burstInterval:1,startColor:[.75,0,.8,1],endColor:[.75,0,.8,0],position:[1.7,.6666896940162155,100]},u.registerType(u,"ParticleSystemFireWork");var f=u;XE.Tool;class y extends XE.Core.XbsjCzmObj{constructor(e,t){super(e,t),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionEditing(this._earth,this,{positionEditingProperty:"positionEditing"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerPositionPicking(this._earth,this,{positionPickingProperty:"creating"})),this.disposers.push(XE.Earth.Interaction.InteractionProperty.registerRotationEditing(this._earth,this,{rotationEditingProperty:"rotationEditing"})),this._viewer=e.czm.viewer,this._particleSystemList=[],this._modelMatrix=Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,new Cesium.Matrix4),this._inverseModelMatrix=Cesium.Matrix4.clone(Cesium.Matrix4.IDENTITY,new Cesium.Matrix4),this._position=new Cesium.Cartesian3,this._colors=[],this.disposers.push(XE.MVVM.watch(()=>[...this.position,...this.rotation],()=>this.updateMatrix())),this.disposers.push(XE.MVVM.watch(()=>[...this.colors],()=>this.updateColors())),this.disposers.push(XE.MVVM.watch(()=>({emissionRate:this.emissionRate,particleSize:this.particleSize}),()=>this.updateCommon())),this.disposers.push(XE.MVVM.watch(()=>this.type,()=>this.changeShowType())),this.disposers.push(XE.MVVM.watch(()=>({radius:this.radius,rotate:this.rotate,height:this.height,particleLife:this.particleLife}),()=>this.update())),this.disposers.push(XE.MVVM.watch(()=>this.particleNumber,()=>{this.update(),this.updateParticleSystemList()})),this.updateParticleSystemList(),this.flyTo()}updateCommon(){this._particleSystemList.forEach(e=>{e.emissionRate=this.emissionRate,e.minimumImageSize.x=this.particleSize,e.minimumImageSize.y=this.particleSize,e.maximumImageSize.x=this.particleSize,e.maximumImageSize.y=this.particleSize})}updateColors(){this._colors.length=0;for(let e=0;e<this.colors.length;e+=4)this._colors.push(new Cesium.Color(this.colors[e],this.colors[e+1],this.colors[e+2],this.colors[e+3]));let e=this._colors.length,t=0;this._particleSystemList.forEach((i,s)=>{t=s%e,i.startColor=this._colors[t],i.endColor=this._colors[t].withAlpha(0)})}update(){this._radiuStep=this.radius/this.particleLife,this._rotateSpeed=this.rotate/this.particleLife,this._speed=this.height/this.particleLife,this.changeUpdateCallBack()}updateMatrix(){let e=new Cesium.Matrix4;Cesium.Cartesian3.fromRadians(...this.position,null,this._position),this._modelMatrix=Cesium.Transforms.eastNorthUpToFixedFrame(this._position);let t=new Cesium.HeadingPitchRoll(...this.rotation),i=Cesium.Quaternion.fromHeadingPitchRoll(t,new Cesium.Quaternion);e=Cesium.Matrix4.fromTranslationQuaternionRotationScale(Cesium.Cartesian3.ZERO,i,new Cesium.Cartesian3(1,1,1),e),Cesium.Matrix4.multiply(this._modelMatrix,e,this._modelMatrix),this._inverseModelMatrix=Cesium.Matrix4.inverse(this._modelMatrix,this._inverseModelMatrix),this._particleSystemList.forEach((e,t)=>{e.modelMatrix=this._modelMatrix}),this.changeUpdateCallBack()}changeUpdateCallBack(){this._particleSystemList.forEach((e,t)=>{e.updateCallback=this.updateCallback(this._radiuStep,this._rotateSpeed,Cesium.Math.TWO_PI*t/this.particleNumber,this._speed,this._inverseModelMatrix,this._modelMatrix)})}updateCallback(e,t,i,s,r,o){let a=new Cesium.Cartesian3;return(n,h)=>{h=Cesium.Math.clamp(h,0,.05),a=Cesium.Matrix4.multiplyByPoint(r,n.position,a),i+=h*t,i%=Cesium.Math.TWO_PI,a.x+=Math.cos(i)*e*h,a.y+=Math.sin(i)*e*h,a.z-=s*h,n.position=Cesium.Matrix4.multiplyByPoint(o,a,n.position)}}updateParticleSystemList(){let e;this.destroy();for(let t=0;t<this.particleNumber;++t){e=t%this._colors.length;let i=this.updateCallback(this._radiuStep,this._rotateSpeed,Cesium.Math.TWO_PI*t/this.particleNumber,this._speed,this._inverseModelMatrix,this._modelMatrix);this._particleSystemList.push(new Cesium.ParticleSystem({image:d(),startColor:this._colors[e],endColor:this._colors[e].withAlpha(0),particleLife:this.particleLife,speed:5e-6,imageSize:new Cesium.Cartesian2(this.particleSize,this.particleSize),emissionRate:this.emissionRate,modelMatrix:this._modelMatrix,lifetime:.1,emitter:new Cesium.CircleEmitter(.01),updateCallback:i}))}this._particleSystemList.forEach(e=>{this._viewer.scene.primitives.add(e)})}flyTo(){this.boundingSphere=new Cesium.BoundingSphere(this._position,Math.sqrt(2*Math.pow(this.radius,2),Math.pow(this.height,2))),this._viewer.camera.flyToBoundingSphere(this.boundingSphere,{duration:2})}changeShowType(){switch(this.type){case"CometTail":this.colors=[...C.comet.colors],this.rotate=C.comet.rotate;break;case"RocketThruster":this.colors=[...C.rocket.colors],this.rotate=C.rocket.rotate}}destroy(){this._particleSystemList=this._particleSystemList.map(e=>{if(e)return this._viewer.scene.primitives.remove(e),e=void 0}),this._particleSystemList.length=0}}y.defaultOptions={type:"CometTail",particleSize:15,emissionRate:30,particleNumber:100,position:[1.67,.6,50],rotation:[0,0,0],colors:[.6,.6,.6,1,.6,.6,.9,.9,.5,.5,.7,.5],radius:30,rotate:.01,height:50,particleLife:3.5};const C={rocket:{colors:[1,.5,.05,1,.9,.6,.01,1,.8,.05,.09,1,1,.05,.09,1],rotate:1},comet:{colors:[.6,.6,.6,1,.6,.6,.9,.9,.5,.5,.7,.5],rotate:.01}};y.registerType(y,"ParticleSystemTails");var _=y;XE.Tool;class g extends r{constructor(e,t){super(e,t),this._pgPositions=[],this.disposers.push(XE.MVVM.watch(()=>[...this.positions.map(e=>[...e])],e=>{const t=e.length;if(t<=2)return;if(function(e,t){if(!e||!t)return!1;M=0;for(let i=0;i<e.length;i++)if(M=e[i]==t[i]?0:1,M>0)return!1;return!0}(e[t-1],e[t-2]))return;this._pgPositions.length=0;let i=[];e.forEach(e=>{i.push(e)}),function(e,t,i=!1,s){if(e.length<3)return;let r,o,a,n,h=e.map(e=>Cesium.Cartesian3.fromRadians(...e,void 0,new Cesium.Cartesian3));s||(s=[]);r=h[0];let l,c=0,p=h.map(e=>(n=Cesium.Cartesian3.distance(r,e),c+=n,r=e,n)),m=[],d=new Cesium.Cartesian3,u=new Cesium.Cartesian3;if(1==i){p.splice(0,1,Cesium.Cartesian3.distance(h[0],h[h.length-1])),c+=p[0],r=h[h.length-1],m=h.map((e,t)=>(o=e,a=h[t+1]||h[0],d=Cesium.Cartesian3.subtract(o,r,d),u=Cesium.Cartesian3.subtract(a,o,u),r=o,l=Cesium.Cartesian3.add(d,u,new Cesium.Cartesian3),Cesium.Cartesian3.multiplyByScalar(l,.5,l)));let i,n=c/(t-e.length),f=0,y=p.map(e=>(i=parseInt((e+f)/n),f=e+f-i*n,i));!function(e,t,i,s){let r,o,a,n,h,l,c,p,m,d,u,f;s.push(t[0]),m=t[0],u=e[0],i.forEach((i,y)=>{d=t[y+1]||t[0],f=e[y+1]||e[0],n=1/i;for(let e=1;e<i;e++){a=e*n,o=a*a,r=o*a,h=2*r-3*o+1,l=-2*r+3*o,c=r-2*o+a,p=r-o;let t=new Cesium.Cartesian3;t.x=h*m.x+l*d.x+c*u.x+p*f.x,t.y=h*m.y+l*d.y+c*u.y+p*f.y,t.z=h*m.z+l*d.z+c*u.z+p*f.z,s.push(t)}m=d,u=f,s.push(d)})}(m,h,y,s)}return s=s.map(e=>{let t=Cesium.Cartographic.fromCartesian(e,void 0,new Cesium.Cartographic);return[t.longitude,t.latitude,t.height]})}(i,20*(t+1),!0,[]).forEach(e=>{this._pgPositions.push(e[0],e[1])}),this._polygon.positions=this._pgPositions,this._polygon.height=e[0][2]}))}}g.registerType(g,"GeoSmoothPolygon");var S=g;let M;XE.Obj.Plots=XE.Obj.Plots||{},XE.Obj.Plots.GeoArrow=n,XE.Obj.Plots.ParticleSystem=p,XE.Obj.Plots.GeoSmoothPolygon=S,XE.Obj.Plots.ParticleSystemFireWork=f,XE.Obj.Plots.ParticleSystemTails=_}]);
//# sourceMappingURL=plottingSymbol2.js.map